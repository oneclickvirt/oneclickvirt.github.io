import{_ as s,v as a,b as l,R as n}from"./chunks/framework.70afa331.js";const d=JSON.parse('{"title":"其他自定义配置","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"guide/lxd/lxd_extra_config.md","filePath":"guide/lxd/lxd_extra_config.md","lastUpdated":1746017733000}'),p={name:"guide/lxd/lxd_extra_config.md"},o=n(`<h1 id="其他自定义配置" tabindex="-1">其他自定义配置 <a class="header-anchor" href="#其他自定义配置" aria-label="Permalink to &quot;其他自定义配置&quot;">​</a></h1><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>以下的配置安装会加重宿主机的负担，非必要不要安装</p></div><h2 id="自动配置ipv6地址" tabindex="-1">自动配置IPV6地址 <a class="header-anchor" href="#自动配置ipv6地址" aria-label="Permalink to &quot;自动配置IPV6地址&quot;">​</a></h2><ul><li>(<em><strong>非必须</strong></em>，不使用的也没问题)</li><li><strong>该脚本仅适用于宿主机有给<code>IPV6</code>子网且是至少<code>/112</code>的，且宿主机绑定了子网的<code>第一个IP</code>做<code>宿主机的IPV6地址或IPV6的gateway</code></strong></li><li>自动为LXD创建的LXC容器配置<code>IPV6</code>地址</li><li>已集成到<code>buildone.sh</code>中可使用变量控制且无需事先下载，该脚本可不手动使用，在使用<code>buildone.sh</code>时配置Y开启即可</li></ul><p>下载脚本</p><p>国际</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">curl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-L</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">https://raw.githubusercontent.com/oneclickvirt/lxd/main/scripts/build_ipv6_network.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-o</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">build_ipv6_network.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">chmod</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">+x</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">build_ipv6_network.sh</span></span></code></pre></div><p>国内</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">curl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-L</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">https://cdn.spiritlhl.net/https://raw.githubusercontent.com/oneclickvirt/lxd/main/scripts/build_ipv6_network.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-o</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">build_ipv6_network.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">chmod</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">+x</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">build_ipv6_network.sh</span></span></code></pre></div><p>自动为容器配置IPV6映射地址(默认不使用iptables进行映射)</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">bash</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">build_ipv6_network.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">容器名称</span></span></code></pre></div><p>映射完毕会打印信息</p><p>示例(给test容器自动配置IPV6地址，配置完成会写入一个test_v6的文件信息)</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">bash</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">build_ipv6_network.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">test</span></span></code></pre></div><p><strong>PS：增加ipv6处理过程中可选择是否使用ip6tables进行映射，默认不使用ip6tables方式进行映射而使用新增网络设备的方式进行映射</strong></p><p>使用ip6tables进行映射</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">bash</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">build_ipv6_network.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">容器名称</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Y</span></span></code></pre></div><p>若使用了ip6tables进行映射，则删除所有IPV6已映射的规则可用：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">ip6tables</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-t</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nat</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-F</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">PREROUTING</span></span>
<span class="line"><span style="color:#FFCB6B;">ip6tables-legacy</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-t</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nat</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-F</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">PREROUTING</span></span>
<span class="line"><span style="color:#FFCB6B;">ip6tables-save</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/iptables/rules.v6</span></span>
<span class="line"><span style="color:#FFCB6B;">netfilter-persistent</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">save</span></span>
<span class="line"><span style="color:#FFCB6B;">netfilter-persistent</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">reload</span></span>
<span class="line"><span style="color:#FFCB6B;">service</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">netfilter-persistent</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">restart</span></span></code></pre></div><p>卸载IPV6地址绑定的守护进程和对应的文件可用：</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">stop</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">add-ipv6.service</span></span>
<span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">disable</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">add-ipv6.service</span></span>
<span class="line"><span style="color:#FFCB6B;">rm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/systemd/system/add-ipv6.service</span></span>
<span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">daemon-reload</span></span>
<span class="line"><span style="color:#FFCB6B;">rm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/usr/local/bin/add-ipv6.sh</span></span></code></pre></div><h2 id="一键安装开lxd宿主机所需要的带vnstat环境的常用预配置环境" tabindex="-1">一键安装开lxd宿主机所需要的带vnstat环境的常用预配置环境 <a class="header-anchor" href="#一键安装开lxd宿主机所需要的带vnstat环境的常用预配置环境" aria-label="Permalink to &quot;一键安装开lxd宿主机所需要的带vnstat环境的常用预配置环境&quot;">​</a></h2><ul><li>(<em><strong>非必须</strong></em>，该脚本仅仅是为了站点对接监控方便，不装的也没问题)</li></ul><p>国际</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">curl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-L</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">https://raw.githubusercontent.com/oneclickvirt/lxd/main/scripts/backend.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-o</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">backend.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">chmod</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">+x</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">backend.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">bash</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">backend.sh</span></span></code></pre></div><p>国内</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">curl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-L</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">https://cdn.spiritlhl.net/https://raw.githubusercontent.com/oneclickvirt/lxd/main/scripts/backend.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-o</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">backend.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">chmod</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">+x</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">backend.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">bash</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">backend.sh</span></span></code></pre></div><h2 id="一键启用官方可视化操作的面板" tabindex="-1">一键启用官方可视化操作的面板 <a class="header-anchor" href="#一键启用官方可视化操作的面板" aria-label="Permalink to &quot;一键启用官方可视化操作的面板&quot;">​</a></h2><ul><li>(<em><strong>非必须</strong></em>，只是为了方便可视化操作，没有也没问题)</li></ul><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">sudo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">snap</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">refresh</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">lxd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--channel=latest/stable</span></span>
<span class="line"><span style="color:#FFCB6B;">snap</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">set</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">lxd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ui.enable=</span><span style="color:#89DDFF;">true</span></span>
<span class="line"><span style="color:#FFCB6B;">lxc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">config</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">set</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">core.https_address</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$(</span><span style="color:#FFCB6B;">curl</span><span style="color:#C3E88D;"> -sKL ipv4.ip.sb</span><span style="color:#89DDFF;">)</span><span style="color:#C3E88D;">:8443</span></span>
<span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">reload</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">snap.lxd.daemon</span></span>
<span class="line"><span style="color:#FFCB6B;">snap</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">restart</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--reload</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">lxd</span></span></code></pre></div><p>然后你可以在浏览器中输入</p><p><code>https://你的公网IPV4地址:8443</code></p><p>即可进入官方可视化操作面板，后续的操作配置按照UI提示操作即可</p><h2 id="一键安装宿主机第三方可视化操作的面板" tabindex="-1">一键安装宿主机第三方可视化操作的面板 <a class="header-anchor" href="#一键安装宿主机第三方可视化操作的面板" aria-label="Permalink to &quot;一键安装宿主机第三方可视化操作的面板&quot;">​</a></h2><ul><li>(<em><strong>非必须</strong></em>，该面板只是为了方便可视化操作，没有也没问题)</li><li>原作者仓库：<a href="https://github.com/turtle0x1/LxdMosaic" target="_blank" rel="noreferrer">跳转</a></li></ul><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">lxc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">config</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">set</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">core.https_address</span><span style="color:#A6ACCD;"> [::]</span></span>
<span class="line"><span style="color:#FFCB6B;">lxc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">config</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">set</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">core.trust_password</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">your_password</span></span>
<span class="line"><span style="color:#FFCB6B;">snap</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">lxdmosaic</span></span></code></pre></div><p>安装完毕后打开宿主机IP地址，按照提示设置admin的密码，其他一路默认就能使用面板了</p>`,37),e=[o];function t(c,r,C,i,y,D){return a(),l("div",null,e)}const h=s(p,[["render",t]]);export{d as __pageData,h as default};

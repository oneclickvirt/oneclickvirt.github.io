import{_ as i,c as a,o as t,ag as l}from"./chunks/framework.CSeR4K32.js";const c=JSON.parse('{"title":"在 LXD 中运行 QEMU 虚拟化的 Linux 虚拟机","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"guide/lxd/lxd_qemu.md","filePath":"guide/lxd/lxd_qemu.md","lastUpdated":1767321810000}'),e={name:"guide/lxd/lxd_qemu.md"};function h(n,s,p,d,k,r){return t(),a("div",null,s[0]||(s[0]=[l(`<h1 id="在-lxd-中运行-qemu-虚拟化的-linux-虚拟机" tabindex="-1">在 LXD 中运行 QEMU 虚拟化的 Linux 虚拟机 <a class="header-anchor" href="#在-lxd-中运行-qemu-虚拟化的-linux-虚拟机" aria-label="Permalink to &quot;在 LXD 中运行 QEMU 虚拟化的 Linux 虚拟机&quot;">​</a></h1><h2 id="开设qemu虚拟机可使用的镜像" tabindex="-1">开设QEMU虚拟机可使用的镜像 <a class="header-anchor" href="#开设qemu虚拟机可使用的镜像" aria-label="Permalink to &quot;开设QEMU虚拟机可使用的镜像&quot;">​</a></h2><p>这里展示一部分可使用的系统参数供你参考：</p><ul><li>debian10，debian11，debian12, debian13</li><li>ubuntu18，ubuntu20，ubuntu22</li><li>centos8，centos9 (实际开设出来都是Stream版本)</li><li>alpine3.15，alpine3.16，alpine3.17，alpine3.18</li><li>openwrt21，openwrt22，fedora37，fedora38，fedora39</li><li>rockylinux8，rockylinux9，oralce8，oracle9</li><li>oralce7，centos7 (都需要在GRUB中启用CGroupV1否则无法启动，详细介绍见常见问题答疑)</li><li>kali，archlinux</li></ul><ul><li>注意都是<strong>小写字母+数字</strong>的组合或<strong>仅小写字母</strong>，自行尝试，如果搜索无该系统则会自动退出脚本</li><li>版本号可以带英文小数点，为了适配alpine的版本号已支持</li><li>开不起来的可能是硬盘或内存不够大或者本身就不适配宿主机，自行尝试查看开不起来的报错</li><li>目前使用的虚拟机系统仅使用 <a href="https://github.com/oneclickvirt/lxd_images" target="_blank" rel="noreferrer">自编译</a> 的镜像，非自编译镜像缺少依赖和设置不可使用</li><li>自编译镜像完整的支持系统的列表：<a href="https://github.com/oneclickvirt/lxd_images/releases/tag/kvm_images" target="_blank" rel="noreferrer">kvm_images</a></li></ul><h2 id="单独生成一个nat服务器" tabindex="-1">单独生成一个NAT服务器 <a class="header-anchor" href="#单独生成一个nat服务器" aria-label="Permalink to &quot;单独生成一个NAT服务器&quot;">​</a></h2><ul><li>只生成一个NAT服务器，可自定义限制所有内容</li></ul><h3 id="下载脚本" tabindex="-1">下载脚本 <a class="header-anchor" href="#下载脚本" aria-label="Permalink to &quot;下载脚本&quot;">​</a></h3><p>国际</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -L</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://raw.githubusercontent.com/oneclickvirt/lxd/main/scripts/buildvm.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> buildvm.sh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +x</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> buildvm.sh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dos2unix</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> buildvm.sh</span></span></code></pre></div><p>国内</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -L</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://cdn.spiritlhl.net/https://raw.githubusercontent.com/oneclickvirt/lxd/main/scripts/buildvm.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> buildvm.sh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +x</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> buildvm.sh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dos2unix</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> buildvm.sh</span></span></code></pre></div><h3 id="使用方法" tabindex="-1">使用方法 <a class="header-anchor" href="#使用方法" aria-label="Permalink to &quot;使用方法&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>./buildvm.sh 服务器名称 CPU核数 内存大小 硬盘大小 SSH端口 外网起端口 外网止端口 下载速度 上传速度 是否启用IPV6(Y or N) 系统(留空则为debian11)</span></span></code></pre></div><p>CPU核数需要小于或等于宿主机的核数，内存大小以MB计算，硬盘大小以GB计算，下载速度上传速度以Mbit计算，是否启用IPV6不一定要填Y或者N，没有这个参数也行，留空默认不开启IPV6</p><p>如果<code>外网起端口</code>和<code>外网止端口</code>都设置为0则不做区间外网端口映射了，只映射基础的SSH端口，注意<code>不能为空</code>，不进行映射需要设置为0</p><p>支持自定义服务器的系统，不填写留空时默认使用debian13，注意传入参数为系统名字+版本号</p><p>除了alpine系统，其他系统的硬盘大小必须大于6G，否则系统起不来，无法初始化和使用，开设的中途阶段就会崩溃。</p><h3 id="示例" tabindex="-1">示例 <a class="header-anchor" href="#示例" aria-label="Permalink to &quot;示例&quot;">​</a></h3><p>以下为开设的示例服务器的信息：</p><table tabindex="0"><thead><tr><th>属性</th><th>值</th></tr></thead><tbody><tr><td>服务器名字</td><td>test</td></tr><tr><td>SSH登录的用户名</td><td>root</td></tr><tr><td>SSH登录的密码</td><td>随机生成</td></tr><tr><td>CPU核数</td><td>1</td></tr><tr><td>内存大小</td><td>256MB</td></tr><tr><td>磁盘大小</td><td>10G</td></tr><tr><td>内外网映射端口一致的区间</td><td>20002到20025</td></tr><tr><td>上传带宽</td><td>500Mbit</td></tr><tr><td>下载带宽</td><td>500Mbit</td></tr><tr><td>自动设置外网IPV6地址</td><td>N</td></tr><tr><td>系统</td><td>debian13</td></tr></tbody></table><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./buildvm.sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 512</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 20001</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 20002</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 20025</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 500</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 500</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> N</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> debian13</span></span></code></pre></div><p>需要进入虚拟机内部则执行</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lxc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> console</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test</span></span></code></pre></div><p>退出则先按住<code>Ctrl</code>再按<code>a</code>，松开后，再按<code>q</code>。</p><p>需要查看信息则执行</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 服务器名字</span></span></code></pre></div><p>比如查询示例的信息就是</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test</span></span></code></pre></div><h3 id="删除测试服务器" tabindex="-1">删除测试服务器 <a class="header-anchor" href="#删除测试服务器" aria-label="Permalink to &quot;删除测试服务器&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lxc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stop</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lxc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> delete</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -rf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -rf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test_v6</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ls</span></span></code></pre></div>`,31)]))}const F=i(e,[["render",h]]);export{c as __pageData,F as default};

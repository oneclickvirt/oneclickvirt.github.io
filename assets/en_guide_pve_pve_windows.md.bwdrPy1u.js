import{_ as t}from"./chunks/wk7.BpuwpIoq.js";import{_ as o,c as i,o as n,ag as s}from"./chunks/framework.CSeR4K32.js";const a="/assets/dlwiniso.BxXucu9m.png",r="/assets/dlwiniso1.CQyxWlSu.png",c="/assets/general.BkOp2iK4.png",d="/assets/os.CX7bMEp5.png",l="/assets/system.C_AmkiPg.png",p="/assets/disks.BJniy5pO.png",h="/assets/cpu.DedcVQ_T.png",g="/assets/memory.CH7Gxf76.png",m="/assets/network.DPXM5W42.png",u="/assets/finish.Cf6DgPp1.png",w="/assets/start.vjgB4hml.png",k="/assets/gic1.XkdPXihx.png",_="/assets/gic2.s5VB7-xp.png",f="/assets/gic3.2zLznATL.png",v="/assets/gic4.CX3t8C19.png",I="/assets/gic5.pjwHWuhn.png",y="/assets/gic6.BnmyenL0.png",b="/assets/gic7.ZYHWzF5W.png",C="/assets/gic8.BwCbmRgC.png",O="/assets/gic9.62-9wTBo.png",S="/assets/net1.CUyp8ayS.png",x="/assets/net2.BP2m5XnQ.png",V="/assets/net3.BJFg7Me5.png",D="/assets/net4.CANZtcPE.png",P="/assets/virtio.CUVhk14O.png",N="/assets/lower2.SPGPKJ4N.png",q="/assets/lower1.DFw6c1iw.png",B="/assets/nodisk.CH47I8Tu.png",M="/assets/nodisk1.gZ09o2py.png",T="/assets/nodisk2.Do6XEKMW.png",U="/assets/nodisk3.1vBQc75S.png",W="/assets/nodisk4.CJjHGgtp.png",A="/assets/wk4.K5XvE6uQ.png",E="/assets/wk5.BEJ5BAWW.png",z="/assets/wk6.D9MKwk3w.png",F="/assets/wk1.BGnwsbrE.png",G="/assets/wk2.BasdNK2d.png",H="/assets/wk3.CWstwLHH.png",Z=JSON.parse('{"title":"Setting Up Windows Visual Machine","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"en/guide/pve/pve_windows.md","filePath":"en/guide/pve/pve_windows.md","lastUpdated":1748869289000}'),K={name:"en/guide/pve/pve_windows.md"};function L(X,e,R,J,j,Q){return n(),i("div",null,e[0]||(e[0]=[s('<h1 id="setting-up-windows-visual-machine" tabindex="-1">Setting Up Windows Visual Machine <a class="header-anchor" href="#setting-up-windows-visual-machine" aria-label="Permalink to &quot;Setting Up Windows Visual Machine&quot;">​</a></h1><h2 id="using-iso-image-with-virtio-for-vm-setup" tabindex="-1">Using ISO Image with VirtIO for VM Setup <a class="header-anchor" href="#using-iso-image-with-virtio-for-vm-setup" aria-label="Permalink to &quot;Using ISO Image with VirtIO for VM Setup&quot;">​</a></h2><h3 id="_1-download-the-image" tabindex="-1">1. Download the Image <a class="header-anchor" href="#_1-download-the-image" aria-label="Permalink to &quot;1. Download the Image&quot;">​</a></h3><p>Before installation, you need to download the image file via <code>local(pve) --&gt; ISO images --&gt; Download from URL</code></p><p>For the download link (<code>URL:</code>), you can use files from: <a href="https://github.com/ILLKX/Windows-VirtIO" target="_blank" rel="noreferrer">https://github.com/ILLKX/Windows-VirtIO</a></p><p>Enter <code>win.iso</code> as the <code>File Name:</code></p><p><img src="'+a+'" alt="download"></p><p>Click <code>Download</code>. After downloading is complete, you can see the file size of <code>win.iso</code> on the current page, confirming it&#39;s in ISO format.</p><p><img src="'+r+'" alt="downloaded"></p><h3 id="_2-setting-up-the-template" tabindex="-1">2. Setting Up the Template <a class="header-anchor" href="#_2-setting-up-the-template" aria-label="Permalink to &quot;2. Setting Up the Template&quot;">​</a></h3><p>Click <code>Create VM</code> in the top right corner of the page.</p><p>In the <code>General</code> window, select <code>mypool</code> for <code>Resource Pool:</code>, enter <code>win</code> for <code>Name</code>, then click <code>Next</code>.</p><p><img src="'+c+'" alt="general"></p><p>In the <code>OS</code> window, select <code>win.iso</code> for <code>ISO image</code>. For <code>Guest OS</code>, select <code>Microsoft Windows</code> as the <code>Type</code> and choose the appropriate <code>Version</code> for your ISO. For example, if you downloaded Windows 2022, select <code>11/2022</code>, then click <code>Next</code>.</p><p><img src="'+d+'" alt="OS"></p><p>In the <code>System</code> window, select <code>VirtIO-GPU</code> for <code>Graphic card</code>, <code>q35</code> for <code>Machine</code>, <code>VirtIO SCSI</code> for <code>SCSI Controller</code>, and <code>Default (SeaBIOS)</code> for <code>BIOS</code>, then click <code>Next</code>.</p><p><img src="'+l+'" alt="system"></p><p>In the <code>Disk</code> window, select <code>Write Back</code> for <code>Cache</code>, enter your desired disk size in <code>Disk size (GiB)</code> (generally not less than <code>20</code>), and choose the storage location in <code>Storage</code>. In this example, only the system disk <code>local</code> is available, so <code>local</code> is selected. Then click <code>Next</code>.</p><p><img src="'+p+'" alt="disk"></p><p>In the <code>CPU</code> window, enter the number of cores needed in <code>Cores</code>, then click <code>Next</code>.</p><p><img src="'+h+'" alt="cpu"></p><p>In the <code>Memory</code> window, enter the desired memory size in <code>Memory (MiB)</code>, then click <code>Next</code>.</p><p><img src="'+g+'" alt="memory"></p><p>In the <code>Network</code> window, select <code>vmbr1</code> for <code>Bridge</code>, <code>VirtIO (paravirtualized)</code> for <code>Model</code>, uncheck <code>Firewall</code>, then click <code>Next</code>.</p><p><img src="'+m+'" alt="Network"></p><p>In the <code>Confirm</code> window, click <code>Finish</code>.</p><p><img src="'+u+'" alt="finish"></p><h3 id="_3-graphical-installation-configuration" tabindex="-1">3. Graphical Installation Configuration <a class="header-anchor" href="#_3-graphical-installation-configuration" aria-label="Permalink to &quot;3. Graphical Installation Configuration&quot;">​</a></h3><p>Click on the template you&#39;ve set up on the left, click <code>Start</code> in the upper right corner to start the virtual machine, then click <code>Console</code> to enter the <code>VNC</code> interface and wait for the operating system to boot.</p><p><img src="'+w+'" alt="console"></p><p>In the VNC, click <code>Next</code>, then <code>Install now</code>, then <code>I don&#39;t have a product key</code>, check <code>Accept license</code>, click <code>Next</code>, and then select <code>Custom installation</code>.</p><p><img src="'+k+'" alt="win0"><img src="'+_+'" alt="win1"><img src="'+f+'" alt="win2"><img src="'+v+'" alt="win3"><img src="'+I+'" alt="win4"></p><p>If the image comes with VirtIO drivers, you should be able to see the available system storage disk and its size. Select it and click <code>Next</code>.</p><p><img src="'+y+'" alt="win5"><img src="'+b+'" alt="win6"></p><p>Wait for the system to install. It may restart automatically several times and could take more than 10 minutes.</p><p><img src="'+C+'" alt="win7"></p><p>After installation is complete, you&#39;ll be asked to set a password during first login.</p><p><img src="'+O+'" alt="win8"></p><p>Once setup is complete, there&#39;s a pop-up box on the left side of the NOVNC page. Click the first button, then follow the login prompt by pressing <code>Ctrl</code>+<code>Alt</code>+last button to enter the login page.</p><h3 id="_4-network-initialization" tabindex="-1">4. Network Initialization <a class="header-anchor" href="#_4-network-initialization" aria-label="Permalink to &quot;4. Network Initialization&quot;">​</a></h3><p>Since the PVE is set up with a static network through this project, you need to manually modify the bound IP address after logging in, rather than using DHCP.</p><p>Right-click in the bottom right corner of the desktop and select <code>Open Network and Internet settings</code>. In the settings page that appears, click <code>Change adapter options</code>. <img src="'+S+'" alt="win9"></p><p>In the <code>Network Connections</code>, select <code>Ethernet</code> and click <code>Change settings of this connection</code>. <img src="'+x+'" alt="win10"></p><p>In the popup window, select <code>Internet Protocol Version 4 (TCP/IPv4)</code> and click <code>Properties</code>. <img src="'+V+`" alt="win11"></p><p>In the new dialog box, select <code>Use the following IP address</code> and enter: IP address(I): <code>172.16.1.xxx</code> (replace xxx with your desired IP, I used 100 for convenience as my vmid is 100) Subnet mask(U): <code>255.255.255.0</code> Default gateway(D): <code>172.16.1.1</code></p><p>Then select <code>Use the following DNS server addresses</code> and enter:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>8.8.8.8</span></span>
<span class="line"><span>144.144.144.144</span></span></code></pre></div><p>Click OK in the bottom right corner, and make sure <code>Validate settings upon exit</code> is NOT checked.</p><p><img src="`+D+'" alt="win12"></p><p>Click <code>OK</code> and <code>Yes</code> for any other dialog boxes, and your virtual machine will now have network connectivity.</p><h3 id="_5-unmounting-the-cd-drive" tabindex="-1">5. Unmounting the CD Drive <a class="header-anchor" href="#_5-unmounting-the-cd-drive" aria-label="Permalink to &quot;5. Unmounting the CD Drive&quot;">​</a></h3><p>Manually click on the corresponding <code>CD</code> in the <code>Hardware</code> on the web side of ProxmoxVE and select <code>Remove</code>, then restart the VM and you can use it directly.</p><p><img src="'+t+'" alt="wk"></p><h2 id="using-iso-images-without-virtio-for-vm-installation" tabindex="-1">Using ISO Images without VirtIO for VM Installation <a class="header-anchor" href="#using-iso-images-without-virtio-for-vm-installation" aria-label="Permalink to &quot;Using ISO Images without VirtIO for VM Installation&quot;">​</a></h2><h3 id="_1-download-images" tabindex="-1">1. Download Images <a class="header-anchor" href="#_1-download-images" aria-label="Permalink to &quot;1. Download Images&quot;">​</a></h3><p>For Windows images without VirtIO, you can use:</p><p><a href="https://down.idc.wiki/ISOS/Windows/" target="_blank" rel="noreferrer">https://down.idc.wiki/ISOS/Windows/</a></p><p>For VirtIO ISO images, you can use:</p><p><a href="https://down.idc.wiki/ISOS/Toolkit/" target="_blank" rel="noreferrer">https://down.idc.wiki/ISOS/Toolkit/</a></p><p>or</p><p><a href="https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/archive-virtio/" target="_blank" rel="noreferrer">https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/archive-virtio/</a></p><p>Alternatively, you can download just the MSI package, package it into an ISO format locally, and then upload it to ProxmoxVE.</p><p>This way, the package is smaller. The official package contains support for all Windows images and is about 500MB, while a self-packaged one is around 5MB.</p><h3 id="_2-virtio-import" tabindex="-1">2. VirtIO Import <a class="header-anchor" href="#_2-virtio-import" aria-label="Permalink to &quot;2. VirtIO Import&quot;">​</a></h3><p>Note that in ProxmoxVE version 8.x and later, you can select VirtIO boot loading by default in the OS section, as shown in the image:</p><p><img src="'+P+'" alt="virtio"></p><p>In lower versions of ProxmoxVE, such as 7.x and 6.x, you cannot select VirtIO boot loading by default in the OS section:</p><p><img src="'+N+'" alt="lower"></p><p>You need to manually add <code>CD/DVD Drive</code> by clicking <code>Add</code> in the <code>Hardware</code> section and selecting the downloaded <code>VirtIO</code> <code>ISO</code> file:</p><p><img src="'+q+'" alt="lower"></p><p>Then proceed as usual until you reach:</p><p><img src="'+B+'" alt="nodisk"></p><p>At this point, you can&#39;t find the hard disk. You need to select <code>Load Driver</code>:</p><p><img src="'+M+'" alt="nodisk"></p><p>Then select the <code>VirtIO</code> as your driver disk, click open, and import the corresponding system driver from the <code>amd64</code> directory:</p><p><img src="'+T+'" alt="nodisk"></p><p>I&#39;m using a <code>Windows Server 2019</code> image, so I imported the <code>2k19</code> driver. After importing, select the imported driver and click <code>Next</code>:</p><p><img src="'+U+'" alt="nodisk"></p><p><img src="'+W+'" alt="nodisk"></p><p>Now you should be able to see the hard disk. Select it and continue with the installation steps as in the previous tutorial until the system installation is complete and you reach the desktop.</p><h3 id="_3-installing-drivers-via-virtio-win-guest-tools" tabindex="-1">3. Installing Drivers via virtio-win-guest-tools <a class="header-anchor" href="#_3-installing-drivers-via-virtio-win-guest-tools" aria-label="Permalink to &quot;3. Installing Drivers via virtio-win-guest-tools&quot;">​</a></h3><p>Once successfully installed and at the desktop, you still need to manually install the drivers.</p><p>Open the <code>VirtIO</code> driver&#39;s <code>CD</code> drive directory. At the bottom, there&#39;s a <code>virtio-win-guest-tools</code> program that will install the required VirtIO drivers, including the VirtIO network card driver:</p><p><img src="'+A+'" alt="wk"></p><p><img src="'+E+'" alt="wk"></p><p><img src="'+z+'" alt="wk"></p><p>After clicking install, the network card driver will be installed. For subsequent network settings, refer to the network initialization tutorial mentioned earlier.</p><h3 id="_4-installing-network-card-driver-alternative" tabindex="-1">4. Installing Network Card Driver (Alternative) <a class="header-anchor" href="#_4-installing-network-card-driver-alternative" aria-label="Permalink to &quot;4. Installing Network Card Driver (Alternative)&quot;">​</a></h3><p>After successful installation and reaching the desktop, you may still need to manually install the network card driver to connect to the network:</p><ol><li>Open <strong>Control Panel</strong> → <strong>Device Manager</strong></li><li>Find the <strong>Ethernet Controller</strong>, right-click and select <strong>Update Driver</strong></li><li>Select <strong>Browse my computer for driver software (R)</strong></li><li>Browse to the <code>VirtIO</code> driver&#39;s <code>CD</code> drive directory</li><li>Open the <strong>NetKVM</strong> folder</li><li>Select the driver folder corresponding to your current system version (like the above operation, I would choose the 2k19 folder with amd64 drivers)</li><li>Confirm the installation, and after completion, the <code>VirtIO</code> network card driver will be successfully loaded</li></ol><p><img src="'+F+'" alt="wk"></p><p><img src="'+G+'" alt="wk"></p><p><img src="'+H+'" alt="wk"></p><p>For subsequent network settings, refer to the network initialization tutorial mentioned earlier.</p><h3 id="_5-unmounting-the-cd-drive-1" tabindex="-1">5. Unmounting the CD Drive <a class="header-anchor" href="#_5-unmounting-the-cd-drive-1" aria-label="Permalink to &quot;5. Unmounting the CD Drive&quot;">​</a></h3><p>In the ProxmoxVE web interface, manually click on the corresponding <code>CD</code> in the <code>Hardware</code> section, select <code>Remove</code>, and then restart the virtual machine. This way, you can use it directly:</p><p><img src="'+t+'" alt="wk"></p>',97)]))}const ee=o(K,[["render",L]]);export{Z as __pageData,ee as default};

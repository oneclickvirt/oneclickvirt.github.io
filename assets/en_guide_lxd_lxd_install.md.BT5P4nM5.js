import{_ as a,c as i,o as e,ag as t}from"./chunks/framework.CSeR4K32.js";const n="/assets/lxdd1.CVTAIewh.png",l="/assets/lxdd2.C_mYE7sL.png",o="/assets/lxdd3.DZ2Na5-t.png",h="/assets/lxdd4.CO1I1FPh.png",p="/assets/lxdd0.QoEngFSd.png",y=JSON.parse('{"title":"","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"en/guide/lxd/lxd_install.md","filePath":"en/guide/lxd/lxd_install.md","lastUpdated":1756132412000}'),r={name:"en/guide/lxd/lxd_install.md"};function d(c,s,k,u,g,m){return e(),i("div",null,s[0]||(s[0]=[t('<h2 id="lxd-installation-guide" tabindex="-1">LXD Installation Guide <a class="header-anchor" href="#lxd-installation-guide" aria-label="Permalink to &quot;LXD Installation Guide&quot;">​</a></h2><p>If your host does not have an IPV6 subnet and you want to assign IPV6 addresses to containers, then please check the <code>Customize</code> partition in the <code>LXD</code> module for the <code>Attach a free IPV6 address segment</code> to the host, and attach an IPV6 subnet to the host before installing the environment.</p><h3 id="one-click-installation" tabindex="-1">One-Click Installation <a class="header-anchor" href="#one-click-installation" aria-label="Permalink to &quot;One-Click Installation&quot;">​</a></h3><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>If this is a new server, make sure that both <code>apt update</code> and <code>apt install curl</code> are working properly before executing this script.</p></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>It&#39;s recommended to wait for at least 5 minutes after the system boots up before executing the following commands. This is to avoid the script being executed by the default system settings, which could cause issues with apt sources.</p></div><ul><li>Prerequisites: Ubuntu 18+ (recommended above 22.04), Debian 8+ (recommended above 11)</li><li>The virtual memory here is talking about the size of the SWAP to be opened, and the storage pool is the sum of the sizes of the disks occupied by all your servers to be opened</li><li>The server needs to be restarted after the environment installation process to load some default configurations</li><li>By default, lxd&#39;s lxcfs-related configuration is enabled, so that in-container querying of container information changes to information about the container itself rather than the host</li><li>This installer has been tested to work on either physical or non-physical machines</li></ul><p>Command:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -L</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://raw.githubusercontent.com/oneclickvirt/lxd/main/scripts/lxdinstall.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lxdinstall.sh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +x</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lxdinstall.sh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bash</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lxdinstall.sh</span></span></code></pre></div><p>OR</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bash</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lxdinstall.sh</span></span></code></pre></div><p>Example of initialization configuration:</p><p>If there is 18GB of unused disk space on the system disk, after deducting the space already occupied, and you want to allocate 2GB of virtual memory (2048MB of SWAP) and a 15GB storage pool, then following the prompts in the command line, enter <code>2048</code> and <code>15</code>.</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>If you need to open more than 200 LXD containers on a single server, then it is not recommended to use this project, there may be problems with lxcfs access drift, which generates IO occupancy that cannot be released. (This is a native LXC problem that can&#39;t be fixed.)</p></div><h3 id="installation-of-web-control-panel" tabindex="-1">Installation of WEB Control Panel <a class="header-anchor" href="#installation-of-web-control-panel" aria-label="Permalink to &quot;Installation of WEB Control Panel&quot;">​</a></h3><p>Customization There are tutorials on how to enable the official panel, but here do not choose to use the official panel, because the official panel in order to security, at the expense of a lot of user experience, this piece of using the</p><p><a href="https://github.com/turtle0x1/LxdMosaic" target="_blank" rel="noreferrer">https://github.com/turtle0x1/LxdMosaic</a></p><p>third-party panels</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> snap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lxdmosaic</span></span></code></pre></div><p>Do a straightforward one-click install, then open the current host&#39;s <code>https://&lt;public IP address&gt;/</code> and force access to it to get to the setup page</p><p><img src="'+n+'" alt="lxd"></p><p><img src="'+l+'" alt="lxd"></p><p><img src="'+o+'" alt="lxd"></p><p>This piece can be changed if you need to set up the site name</p><p><img src="'+h+`" alt="lxd"></p><p>Better than nothing can only mean that there is no RBAC access control for sub-user segregation</p><h3 id="manual-installation-optional" tabindex="-1">Manual installation (optional) <a class="header-anchor" href="#manual-installation-optional" aria-label="Permalink to &quot;Manual installation (optional)&quot;">​</a></h3><p>Not recommended, just for some odd environments where one-click scripts won&#39;t run.</p><h4 id="disable-firewall" tabindex="-1">Disable Firewall <a class="header-anchor" href="#disable-firewall" aria-label="Permalink to &quot;Disable Firewall&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> curl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dos2unix</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ufw</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> jq</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ufw</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> disable</span></span></code></pre></div><h4 id="enabling-virtual-memory-swap" tabindex="-1">Enabling Virtual Memory SWAP <a class="header-anchor" href="#enabling-virtual-memory-swap" aria-label="Permalink to &quot;Enabling Virtual Memory SWAP&quot;">​</a></h4><p>The amount of memory depends on how many instances you want to run. If you want to run 8 instances and calculate, you&#39;ll need 2GB of memory. If your actual physical memory is 512MB, you&#39;ll need an additional 1.5GB. To be cautious, allocate 2GB of virtual memory.</p><p>Execute the following commands: Enter &#39;1&#39;, then enter &#39;2048&#39;. This signifies allocating 2GB of virtual memory.</p><p>Command:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -L</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://raw.githubusercontent.com/oneclickvirt/lxd/main/scripts/swap.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> swap.sh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +x</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> swap.sh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bash</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> swap.sh</span></span></code></pre></div><h4 id="installing-lxd" tabindex="-1">Installing LXD <a class="header-anchor" href="#installing-lxd" aria-label="Permalink to &quot;Installing LXD&quot;">​</a></h4><p>Actually, the virtual memory allocated for swap should be twice the size of the actual memory. So, it&#39;s reasonable to allocate 1GB if the actual memory is 500MB. The scenario I described above is an excessive allocation.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>apt install snapd -y</span></span>
<span class="line"><span>snap install lxd</span></span>
<span class="line"><span>/snap/bin/lxd init</span></span></code></pre></div><p>If the following error occurs in the above command</p><p>(snap &quot;lxd&quot; assumes unsupported features: snapd2.39 (try to update snapd and refresh the core snap))</p><p>Use the command patch before installing lxd</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>snap install core</span></span></code></pre></div><p>If there are no exceptions, the results of the above three lines of commands are as follows</p><p><img src="`+p+`" alt=""></p><p>Just enter the default for the normal options</p><p>Choose the size of the physical disk (hint: select the default option with a minimum of 1GB). Generally, I fill in the available disk space minus the memory size, then multiply by 0.95 and round down. Here, I entered 10GB.</p><p>Remember to select &#39;no&#39; for options containing &#39;auto&#39; when prompted to update the image, in order to avoid occupying the system.</p><p>Test whether symbolic links are functioning in LXC.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>lxc -h</span></span></code></pre></div><p>If an error is reported then execute the following command to soft connect the lxc command</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> lxc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/dev/null</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> 2&gt;&amp;1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;alias lxc=&quot;/snap/bin/lxc&quot;&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /root/.bashrc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /root/.bashrc</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PATH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$PATH:/snap/bin</span></span></code></pre></div><p>After connecting, test the lxc command again to see if there is an error about not being able to find it</p>`,51)]))}const F=a(r,[["render",d]]);export{y as __pageData,F as default};

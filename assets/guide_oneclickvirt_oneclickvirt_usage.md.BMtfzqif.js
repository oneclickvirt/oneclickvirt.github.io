import{_ as i,c as a,o as n,ag as l}from"./chunks/framework.CSeR4K32.js";const c=JSON.parse('{"title":"使用说明","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"guide/oneclickvirt/oneclickvirt_usage.md","filePath":"guide/oneclickvirt/oneclickvirt_usage.md","lastUpdated":1760716646000}'),e={name:"guide/oneclickvirt/oneclickvirt_usage.md"};function p(h,s,t,k,d,r){return n(),a("div",null,s[0]||(s[0]=[l(`<h1 id="使用说明" tabindex="-1">使用说明 <a class="header-anchor" href="#使用说明" aria-label="Permalink to &quot;使用说明&quot;">​</a></h1><p>这里将详细说明本面板的使用方式，如有问题请加群求助管理员或群友：<a href="https://t.me/oneclickvirt" target="_blank" rel="noreferrer">https://t.me/oneclickvirt</a></p><h2 id="用户管理" tabindex="-1">用户管理 <a class="header-anchor" href="#用户管理" aria-label="Permalink to &quot;用户管理&quot;">​</a></h2><p>登录进入管理员界面后，打开用户管理页面后，必须点击重置密码，以确保admin账户的密码为强密码，确保不会被恶意爆破。如果初始化的时候，你使用了自行定义的密码，那么不重置密码也可以。</p><p>重置密码会自动生成强密码，仅展示一次，务必复制保存好，避免遗忘。</p><p>(如果忘记了密码，需要通过数据库操作强行更改密码，占位施工)</p><p>如果需要更改用户的类型，就需要点击对应用户进行编辑，编辑的弹窗支持更改用户类型。</p><p>管理员可以点击右上角头像，下拉栏目中有切换管理员和普通用户视图的按钮，如果需要测试任何功能，可以直接使用管理员用户测试。(普通用户没有这个视图切换按钮)</p><h2 id="纳管节点" tabindex="-1">纳管节点 <a class="header-anchor" href="#纳管节点" aria-label="Permalink to &quot;纳管节点&quot;">​</a></h2><p>首先，需要确保要纳管的节点已经安装了四大虚拟化技术的其中之一。</p><p>部署了本面板的机器上ping对应的节点的IP，最好延迟在300ms以内且丢包率不要太高，否则可能出现无法连接导致控制中遗漏命令执行的情况。</p><p>以下是录入节点的设置步骤：</p><ol><li>录入节点基础信息(必须)</li></ol><p>录入登录信息的下方，有一个测试按钮，一般来说不需要手动修改对应的连接参数，如果延迟过高或者丢包率很高，那么最好将参数按照提示调高一些，增加容错率。</p><ol start="2"><li>设置节点所在位置(可选)</li></ol><p>直接输入具体国家进行勾选，主流国家都已经有预设了，有对应的旗帜图标。设置位置后，普通用户的申请领取界面将可以看到对应的旗帜和地区，还有自动匹配的所在大洲。</p><ol start="3"><li>设置节点支持开设的实例类型和对应实例类型的数量限制(必须)</li></ol><p>对于docker类型的节点，只能开设容器，其他虚拟化类型都支持开设虚拟机和容器。如果不需要开设虚拟机，务必取消虚拟机的勾选。</p><p>数量限制如果保持默认的参数0，意味着不进行节点层面的这个类型的实例类型数量限制。对于容器，建议按照以下公式设置数量</p><p>节点空闲存储盘大小 / 将分发的实例的最小硬盘大小 = 实例最大数量</p><p>对于虚拟机，则</p><p>节点空闲内存大小(含虚拟内存) / 将分发的实例的最小内存大小 = 实例数量</p><p>这样计算的原因在于，容器一般不限制总的CPU数量和内存大小，但限制硬盘大小，虚拟机一般内存才是开设数量的瓶颈。</p><ol start="4"><li>设置实例类型对应的资源超配置(可选)</li></ol><p>默认容器类型不限制CPU和内存预分配的总量，但限制预分配的硬盘总量，以达到最优化的资源共享和最大化的实例数量。</p><p>默认虚拟机类型限制所有资源，预分配的总量最大值不能超过实际资源大小。</p><p>具体来说，如果你需要限制哪种资源不被超开，那么就点击限制，限制后将无法超开对应资源。</p><p>这块的限制是限制在对应类型的实例在这个节点上总的资源占用，这里的资源占用是预分配的，不是实际的实例占用，仅用于计算空闲资源限制开设。</p><p>不推荐进行修改，除非你知道这块的设置在干什么。</p><ol start="5"><li>设置节点层面的等级限制(必选)</li></ol><p>这块预设了5个等级，用户申请领取的时候，将经过这个限制筛选配置。</p><p>在实际实例开设过程中，该 节点层面的等级限制 将与 全局的用户等级的资源限制 互相比对，取其中的最小值作为用户在当前节点可用的资源限制。</p><ol start="6"><li>设置带宽和流量(必选)</li></ol><p>字面意思，设置节点的最大带宽和以自然月计算的流量可用值，默认自动启用流量监控和流量统计。</p><p>实例流量超过节点限制或用户限制时，将自动停止实例；节点总的流量超限时，将停止整个节点的所有实例。</p><p>月初会重置统计数据，并重新启动所有实例。</p><ol start="6"><li>高级设置(可选)</li></ol><p>可以控制对于节点操作的详细参数：</p><p>默认单线程串联执行，同一时刻，只会存在一个增删改的任务(对应实例的开设删除重置操作)。</p><p>可以更改为多线程并发执行，同一时刻可以存在多个增删改任务，只有并发执行时，并发数量的设置才有意义。</p><p>串联执行适合节点本身性能弱或平台用户数量少的情况，并发操作适合节点本身性能强或用户数量多的情况，请自行选择模式。个人推荐使用默认设置，并发执行可能存在未完全测试出来的边界条件，可能有BUG。</p><p>节点操作模式支持 仅API，仅SSH，自动切换 ，默认使用自动模式，一般来说没必要修改，除非有特殊需求。</p><p>如果需要启用API操作模式，需要在录入节点成功后，在外面点击自动配置API按钮，将执行后台任务自动对接虚拟化平台的API，无需人工配置。等待一段时间大概15~20秒后，应该已经配置成功，点击按钮可见配置历史任务及对应的日志。配置成功后，再点击健康检测，确保API状态为绿色在线状态，就配置启用API成功了。</p><ol start="7"><li>进行健康检测(必选)</li></ol><p>健康检测后普通用户才能看到对应的服务器，才能进行申请开设，若未进行健康检测，用户无法申请开设领取。</p><h2 id="镜像管理" tabindex="-1">镜像管理 <a class="header-anchor" href="#镜像管理" aria-label="Permalink to &quot;镜像管理&quot;">​</a></h2><p>占位待施工</p><h2 id="系统管理" tabindex="-1">系统管理 <a class="header-anchor" href="#系统管理" aria-label="Permalink to &quot;系统管理&quot;">​</a></h2><p>占位待施工</p><h2 id="配置文件" tabindex="-1">配置文件 <a class="header-anchor" href="#配置文件" aria-label="Permalink to &quot;配置文件&quot;">​</a></h2><p>默认的设置已经足够轻度使用了，如果需要高级自定义则需要修改配置文件,或初始化后在管理员界面进行修改。</p><p><a href="https://github.com/oneclickvirt/oneclickvirt/blob/main/server/config.yaml" target="_blank" rel="noreferrer">https://github.com/oneclickvirt/oneclickvirt/blob/main/server/config.yaml</a></p><p>这里是完整的初始化的配置文件，下面将讲解具体的配置项目：</p><h3 id="auth-认证配置" tabindex="-1">auth 认证配置 <a class="header-anchor" href="#auth-认证配置" aria-label="Permalink to &quot;auth 认证配置&quot;">​</a></h3><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">auth</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    email-password</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    email-smtp-host</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    email-smtp-port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;3306&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    email-username</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">root</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    enable-email</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    enable-oauth2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    enable-public-registration</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    enable-qq</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    enable-telegram</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    qq-app-id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    qq-app-key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    telegram-bot-token</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    frontend-url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span></span></code></pre></div><p>认证模块的配置项,用于控制用户登录注册的方式和第三方登录集成。</p><ul><li><code>email-password</code>: 邮件服务的认证密码,用于SMTP发送邮件时的身份验证</li><li><code>email-smtp-host</code>: SMTP服务器地址,如 <code>smtp.gmail.com</code></li><li><code>email-smtp-port</code>: SMTP服务器端口,常用端口为 <code>25</code>、<code>465</code>(SSL)、<code>587</code>(TLS)</li><li><code>email-username</code>: SMTP服务器登录用户名,通常是完整的邮箱地址</li><li><code>enable-email</code>: 是否启用邮箱登录功能</li><li><code>enable-oauth2</code>: 是否启用OAuth2第三方登录功能</li><li><code>enable-public-registration</code>: 是否允许公开注册,关闭后仅管理员可创建账号</li><li><code>enable-qq</code>: 是否启用QQ登录</li><li><code>enable-telegram</code>: 是否启用Telegram登录</li><li><code>qq-app-id</code>: QQ互联平台申请的App ID</li><li><code>qq-app-key</code>: QQ互联平台申请的App Key</li><li><code>telegram-bot-token</code>: Telegram Bot的API Token</li><li><code>frontend-url</code>: 前端访问地址,需要包含协议头(<code>http://</code>或<code>https://</code>),结尾斜杠可选。OAuth2回调地址依赖此配置</li></ul><h3 id="captcha-验证码配置" tabindex="-1">captcha 验证码配置 <a class="header-anchor" href="#captcha-验证码配置" aria-label="Permalink to &quot;captcha 验证码配置&quot;">​</a></h3><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">captcha</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    expire-time</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">300</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    height</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">40</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    width</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">120</span></span></code></pre></div><p>图形验证码的生成和验证配置,用于前端登录注册页面的安全验证。</p><ul><li><code>enabled</code>: 是否启用验证码功能</li><li><code>expire-time</code>: 验证码过期时间,单位为秒</li><li><code>height</code>: 验证码图片高度,单位为像素</li><li><code>length</code>: 验证码字符长度</li><li><code>width</code>: 验证码图片宽度,单位为像素</li></ul><h3 id="cdn-内容分发网络配置" tabindex="-1">cdn 内容分发网络配置 <a class="header-anchor" href="#cdn-内容分发网络配置" aria-label="Permalink to &quot;cdn 内容分发网络配置&quot;">​</a></h3><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">cdn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    base-endpoint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">https://cdn.spiritlhl.net/</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    endpoints</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">https://cdn0.spiritlhl.top/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">http://cdn3.spiritlhl.net/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">http://cdn1.spiritlhl.net/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">http://cdn2.spiritlhl.net/</span></span></code></pre></div><p>系统镜像下载时使用的CDN加速节点配置。</p><ul><li><code>base-endpoint</code>: 主CDN节点地址,优先使用</li><li><code>endpoints</code>: 备用CDN节点列表,按顺序进行重试。系统会自动选择可用节点进行镜像下载</li></ul><p>一般情况下不需要修改此配置,预载的系统镜像都托管在本组织仓库中,默认CDN节点已能提供良好的下载加速。</p><h3 id="mysql-数据库配置" tabindex="-1">mysql 数据库配置 <a class="header-anchor" href="#mysql-数据库配置" aria-label="Permalink to &quot;mysql 数据库配置&quot;">​</a></h3><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    auto-create</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">charset=utf8mb4&amp;parseTime=True&amp;loc=Local</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    db-name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">oneclickvirt</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    engine</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">InnoDB</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    log-mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">error</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    log-zap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    max-idle-conns</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    max-lifetime</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3600</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    max-open-conns</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    password</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    prefix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    singular</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    username</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">root</span></span></code></pre></div><p>MySQL数据库连接和行为配置。初始化判断逻辑:当<code>path</code>和<code>port</code>都为空时,系统认为需要进行初始化,此时必须确保目标数据库为空数据库。</p><ul><li><code>auto-create</code>: 是否自动创建数据库(如果不存在)</li><li><code>config</code>: 数据库连接参数,包括字符集、时间解析等</li><li><code>db-name</code>: 数据库名称</li><li><code>engine</code>: 数据库存储引擎,推荐使用InnoDB</li><li><code>log-mode</code>: 数据库日志模式,可选值为<code>silent</code>、<code>error</code>、<code>warn</code>、<code>info</code></li><li><code>log-zap</code>: 是否使用zap日志库记录数据库日志</li><li><code>max-idle-conns</code>: 最大空闲连接数</li><li><code>max-lifetime</code>: 连接最大生命周期,单位为秒</li><li><code>max-open-conns</code>: 最大打开连接数</li><li><code>password</code>: 数据库密码</li><li><code>path</code>: 数据库服务器地址</li><li><code>port</code>: 数据库服务器端口</li><li><code>prefix</code>: 数据表名前缀</li><li><code>singular</code>: 是否使用单数表名(默认为复数)</li><li><code>username</code>: 数据库用户名</li></ul><h3 id="quota-配额限制配置" tabindex="-1">quota 配额限制配置 <a class="header-anchor" href="#quota-配额限制配置" aria-label="Permalink to &quot;quota 配额限制配置&quot;">​</a></h3><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">quota</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    default-level</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    instance-type-permissions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        min-level-for-container</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        min-level-for-delete</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        min-level-for-vm</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    level-limits</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">            max-instances</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">            max-resources</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">                bandwidth</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">                cpu</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">                disk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1025</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">                memory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">350</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">            max-traffic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">102400</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">            max-instances</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">            max-resources</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">                bandwidth</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">                cpu</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">                disk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20480</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">                memory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1024</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">            max-traffic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">204800</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">            max-instances</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">            max-resources</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">                bandwidth</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">                cpu</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">                disk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">40960</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">                memory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2048</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">            max-traffic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">307200</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">            max-instances</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">            max-resources</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">                bandwidth</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">                cpu</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">                disk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">81920</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">                memory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4096</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">            max-traffic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">409600</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">            max-instances</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">            max-resources</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">                bandwidth</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">                cpu</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">                disk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">163840</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">                memory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8192</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">            max-traffic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">512000</span></span></code></pre></div><p>用户等级和资源配额的控制配置。内存、硬盘、流量的默认单位均为MB。</p><h4 id="全局配置" tabindex="-1">全局配置 <a class="header-anchor" href="#全局配置" aria-label="Permalink to &quot;全局配置&quot;">​</a></h4><ul><li><code>default-level</code>: 新注册用户的默认等级</li></ul><h4 id="instance-type-permissions-实例类型权限" tabindex="-1">instance-type-permissions 实例类型权限 <a class="header-anchor" href="#instance-type-permissions-实例类型权限" aria-label="Permalink to &quot;instance-type-permissions 实例类型权限&quot;">​</a></h4><p>控制不同等级用户可以执行的操作类型。</p><ul><li><code>min-level-for-container</code>: 创建容器实例所需的最低用户等级</li><li><code>min-level-for-delete</code>: 在普通用户端执行删除操作所需的最低等级</li><li><code>min-level-for-vm</code>: 创建虚拟机实例所需的最低用户等级</li></ul><h4 id="level-limits-等级配额限制" tabindex="-1">level-limits 等级配额限制 <a class="header-anchor" href="#level-limits-等级配额限制" aria-label="Permalink to &quot;level-limits 等级配额限制&quot;">​</a></h4><p>定义每个用户等级对应的资源配额上限,键为等级数字。</p><p>每个等级包含以下配置:</p><ul><li><code>max-instances</code>: 该等级用户可创建的最大实例数量</li><li><code>max-resources</code>: 单个实例的最大资源限制 <ul><li><code>bandwidth</code>: 最大带宽,单位为Mbps</li><li><code>cpu</code>: 最大CPU核心数</li><li><code>disk</code>: 最大硬盘空间,单位为MB</li><li><code>memory</code>: 最大内存,单位为MB</li></ul></li><li><code>max-traffic</code>: 该等级用户的最大总流量,单位为MB</li></ul><h3 id="zap-日志配置" tabindex="-1">zap 日志配置 <a class="header-anchor" href="#zap-日志配置" aria-label="Permalink to &quot;zap 日志配置&quot;">​</a></h3><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">zap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    compress-logs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    director</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">storage/logs</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    encode-level</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">LowercaseLevelEncoder</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    format</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">console</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    level</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">info</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    log-in-console</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    max-array-elements</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    max-backups</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    max-file-size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    max-log-length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2000</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    max-string-length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    prefix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;[oneclickvirt]&#39;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    retention-day</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    show-line</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    stacktrace-key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">stacktrace</span></span></code></pre></div><p>系统日志记录的详细配置,基于zap日志库。</p><ul><li><code>compress-logs</code>: 是否压缩归档的日志文件</li><li><code>director</code>: 日志文件存储目录</li><li><code>encode-level</code>: 日志级别编码方式,可选<code>LowercaseLevelEncoder</code>(小写)、<code>CapitalLevelEncoder</code>(大写)</li><li><code>format</code>: 日志输出格式,可选<code>console</code>(控制台格式)、<code>json</code>(JSON格式)</li><li><code>level</code>: 日志级别,可选<code>debug</code>、<code>info</code>、<code>warn</code>、<code>error</code>。开发调试时建议使用<code>debug</code>,生产环境使用<code>info</code>或<code>warn</code></li><li><code>log-in-console</code>: 是否同时输出日志到控制台</li><li><code>max-array-elements</code>: 数组类型字段最大记录元素数</li><li><code>max-backups</code>: 保留的历史日志文件最大数量</li><li><code>max-file-size</code>: 单个日志文件最大大小,单位为MB</li><li><code>max-log-length</code>: 单条日志最大长度,超出部分会被截断</li><li><code>max-string-length</code>: 字符串字段最大记录长度</li><li><code>prefix</code>: 日志前缀标识</li><li><code>retention-day</code>: 日志文件保留天数,过期自动删除</li><li><code>show-line</code>: 是否显示日志调用的文件名和行号</li><li><code>stacktrace-key</code>: 堆栈跟踪信息的键名</li></ul><p>注意:调试问题时应将<code>level</code>设置为<code>debug</code>以获取详细日志信息。</p>`,87)]))}const o=i(e,[["render",p]]);export{c as __pageData,o as default};

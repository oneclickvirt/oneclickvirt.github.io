import{_ as i,c as a,o as t,ag as p}from"./chunks/framework.CSeR4K32.js";const e="/assets/pve_kvm_1.BEDy-Dxt.png",l="/assets/pve_kvm_2.C98l0GO8.png",h="/assets/pve_kvm_3.DzuyyWMo.png",b=JSON.parse('{"title":"前言","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"guide/pve/pve_precheck.md","filePath":"guide/pve/pve_precheck.md","lastUpdated":1761821153000}'),n={name:"guide/pve/pve_precheck.md"};function r(k,s,d,c,o,g){return t(),a("div",null,s[0]||(s[0]=[p(`<h1 id="前言" tabindex="-1">前言 <a class="header-anchor" href="#前言" aria-label="Permalink to &quot;前言&quot;">​</a></h1><p>以下为非自定义部分的介绍，自定义部分有自己对应的介绍，勿弄混了</p><p>如果有未适配的商家或机器欢迎联系<a href="https://t.me/spiritlhl_bot" target="_blank" rel="noreferrer">@spiritlhl_bot</a>，有空会尝试支持一下</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>会改变宿主机的网络结构，请保证宿主机随时可重置系统，且运行前无重要数据在宿主机上。</p></div><p>欢迎给项目一个<code>Star</code>进行免费的支持--&gt;<a href="https://github.com/oneclickvirt/pve" target="_blank" rel="noreferrer">https://github.com/oneclickvirt/pve</a></p><h2 id="各种要求" tabindex="-1">各种要求 <a class="header-anchor" href="#各种要求" aria-label="Permalink to &quot;各种要求&quot;">​</a></h2><p>建议debian在使用前尽量使用最新的稳定版本的系统</p><p><strong>警告：一键安装PVE仅支持具有独立公网IPv4地址的服务器</strong></p><p>本项目依赖固定的 IPV4 地址进行网络分配，不支持以下情况：</p><ul><li>动态 IPV4 的环境（如机器重启后 IP 会变更的服务器）</li><li>无独立的公网 IPV4 的环境（如通过家庭路由器 NAT 上网，需 DHCP 获取地址的情况）</li></ul><p>如您的服务器不具备可分配的公网固定 IPv4 地址，请勿使用本项目。</p><p>本项目的一键安装脚本只适配Debian系统，非Debian无法通过APT源安装，官方只给了Debian的镜像，其他系统只能使用ISO安装，或使用自定义分区和常见问题分区中的其他方式解决问题。</p><ul><li>系统要求：Debian 8+</li></ul><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>建议debian12+而不是debian11，debian11在部分独立服务器上有网络重启的BUG。</p></div><ul><li>硬件要求：2核2G内存<code>x86_64</code>或<code>arm</code>架构服务器硬盘至少20G</li><li>可开KVM的硬件要求：VM-X或AMD-V支持 (部分VPS和全部独服支持)</li><li>如果硬件或系统需求不满足，可使用incus批量开LXC容器<a href="https://github.com/oneclickvirt/incus" target="_blank" rel="noreferrer">跳转</a></li></ul><p>如果使用IPV6隧道进行宿主机的IPV6子网附加，务必在PVE安装成功但网关未自动设置时在对应文件添加内容，不要在一开始(未安装PVE)就进行IPV6隧道的添加。</p><h2 id="开设虚拟内存-swap-非必须的可选项" tabindex="-1">开设虚拟内存(SWAP)(非必须的可选项) <a class="header-anchor" href="#开设虚拟内存-swap-非必须的可选项" aria-label="Permalink to &quot;开设虚拟内存(SWAP)(非必须的可选项)&quot;">​</a></h2><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>内存开点swap免得机器炸了，如果你的宿主机内存不够用硬盘又很多空闲的话</p></div><p>单位换算：输入 1024 产生 1G SWAP-虚拟内存，虚拟内存占用硬盘空间，当实际内存不够用时将自动使用虚拟内存做内存使用，但随之带来IO高占用以及CPU性能占用</p><p>参考本组织相关项目的说明 <a href="https://github.com/oneclickvirt/ecs/blob/master/README_NEW_USER.md" target="_blank" rel="noreferrer">跳转</a> 这块开设虚拟内存的大小</p><table tabindex="0"><thead><tr><th>物理内存大小</th><th>推荐 SWAP 大小</th></tr></thead><tbody><tr><td>≤ 2G</td><td>内存的 2 倍</td></tr><tr><td>2G &lt; 内存 ≤ 8G</td><td>等于物理内存大小</td></tr><tr><td>≥ 8G</td><td>约 8G 即可</td></tr><tr><td>需要休眠 (hibernation)</td><td>至少等于物理内存大小</td></tr></tbody></table><p>国际</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -L</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://raw.githubusercontent.com/spiritLHLS/addswap/main/addswap.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> addswap.sh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +x</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> addswap.sh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bash</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> addswap.sh</span></span></code></pre></div><p>国内</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -L</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://cdn.spiritlhl.net/https://raw.githubusercontent.com/spiritLHLS/addswap/main/addswap.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> addswap.sh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +x</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> addswap.sh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bash</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> addswap.sh</span></span></code></pre></div><h2 id="检测环境" tabindex="-1">检测环境 <a class="header-anchor" href="#检测环境" aria-label="Permalink to &quot;检测环境&quot;">​</a></h2><ul><li>本项目相关脚本执行前务必执行本脚本检测环境，如果不符合安装PVE的要求则无法使用后续的脚本</li><li>检测本机IPV6的网络配置情况(有无IPV6都可安装，只是查询一下罢了)</li><li>检测硬件配置是否满足最低要求</li><li>检测硬件环境是否可嵌套虚拟化KVM类型的服务器，不可嵌套虚拟化KVM的也可以开QEMU的TCG的服务器，性能较差</li><li>检测系统环境是否可嵌套虚拟化KVM类型的服务器，不可嵌套虚拟化KVM的也可以开QEMU的TCG的服务器，性能较差</li><li>不可嵌套虚拟化KVM的服务器不推荐安装PVE，不如使用<a href="https://github.com/oneclickvirt/incus" target="_blank" rel="noreferrer">incus</a>性能更好</li></ul><p>国际</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bash</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &lt;(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wget</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -qO-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --no-check-certificate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://raw.githubusercontent.com/oneclickvirt/pve/main/scripts/check_kernal.sh)</span></span></code></pre></div><p>国内</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bash</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &lt;(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wget</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -qO-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --no-check-certificate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://cdn.spiritlhl.net/https://raw.githubusercontent.com/oneclickvirt/pve/main/scripts/check_kernal.sh)</span></span></code></pre></div><p>如果你需要更新IPV6信息再查询，那么执行以下命令后再查询</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -rf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/bin/pve_ipv6</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -rf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/bin/pve_check_ipv6</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -rf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/bin/pve_last_ipv6</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span></code></pre></div><p><strong>执行本项目的检测环境的命令</strong>，展示如下</p><p><img src="`+e+'" alt="图片"></p><p>查询如上的只需使用下面的一键脚本自动创建虚拟机即可，无需手动再修改WEB端设置</p><p><img src="'+l+'" alt="图片"></p><p>查询如上的在使用后续脚本创建了虚拟机后，<strong>可能</strong>需要手动修改WEB端设置，需要关闭对应每个虚拟机的硬件嵌套虚拟化，如下图</p><p><img src="'+h+'" alt="图片"></p><p>先停止虚拟机再修改，修改完后再开机才能使用NOVNC，不关闭<strong>可能</strong>导致这个虚拟机有BUG无法使用</p><p>如果强行安装PVE开KVM，启动不了的也可以关闭这个选项试试能不能启动虚拟机，导致这些问题的原因就是上面说的，宿主机不支持嵌套虚拟化KVM进行加速</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>开设虚拟机前请使用screen挂起执行，避免开设时间过长，SSH不稳定导致中间执行中断</p></div><br><br>',44)]))}const u=i(n,[["render",r]]);export{b as __pageData,u as default};
